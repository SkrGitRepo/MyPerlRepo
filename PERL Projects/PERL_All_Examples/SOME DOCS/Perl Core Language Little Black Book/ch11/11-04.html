<HTML>
<HEAD>
<META name=vsisbn content="1576104265">
<META name=vstitle content="Perl Core Language Little Black Book">
<META name=vsauthor content="Steven Holzner">
<META name=vspublisher content="The Coriolis Group">
<META name=vspubdate content="03/01/99">
<META name=vscategory content="Web and Software Development: Open Source Development: Languages: Perl,Web and Software Development: Programming, Scripting, and Markup Languages: Perl">





<TITLE>Perl Core Language Little Black Book:Built-In Functions: I/O And Interprocess Communication</TITLE>

<!-- HEADER -->

<STYLE type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
</STYLE>

<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
         var Win = window.open(url,"displayWindow",'width=' + width +',height=' + height + ',resizable=1,scrollbars=yes');
	if (Win) {
		Win.focus();
	}
}
//-->
</script>
<SCRIPT>
<!--
function popUp(url) {
        var Win = window.open(url,"displayWindow",'width=400,height=300,resizable=1,scrollbars=yes');
	if (Win) {
		Win.focus();
	}
}
//-->
</SCRIPT>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//-->
</script>

<SCRIPT LANGUAGE="JavaScript">
<!--
var axel = Math.random() + "";
var ord = axel * 1000000000000000000 + "?";

//This part of script alleviates a Netscape document.write bug
<!-- 
NS4 = document.layers;
if (NS4) {
origWidth = innerWidth;
origHeight = innerHeight;
}
function reDo() {
if (innerWidth != origWidth || innerHeight != origHeight) 
location.reload();
}
if (NS4) onresize = reDo;
//-->
</SCRIPT> 
</HEAD>

<body background="/images/back.jpg" bgcolor="#FFFFFF" link="#003399" alink="#FF0000" vlink="#003399" topmargin=0 leftmargin=0 marginheight=0 marginwidth=0>

<table bgcolor="#003366" width="100%" border="0" cellpadding="0" cellspacing="0">
	<tr valign="top">
		<td height="95">
		&nbsp;&nbsp;<a href="http://www.earthweb.com" target="resource window"><img src="/images/ew_logo.jpg" width="82" height="58" alt="EarthWeb" border="0"></a>&nbsp;&nbsp;&nbsp;</td>
		<td height=95">
		<table width="100%">
			<tr valign="top">
			<td bgcolor="#003366" nowrap>
<SCRIPT LANGUAGE="javascript">
<!--
document.write('<NOLAYER>');
document.write('<IFRAME SRC="http://ad.doubleclick.net/adi/itk.earthweb.dart/b_soft_dev;a=b_soft_dev1;sz=468x60;ord=' + ord + '" width="468" height="60" frameborder="no" border="0" MARGINWIDTH="0" MARGINHEIGHT="0" SCROLLING="no">');
document.write('<A HREF="http://ad.doubleclick.net/jump/itk.earthweb.dart/b_soft_dev;abr=!ie;a=b_soft_dev1;sz=468x60;ord=' + ord + '" target="_top"><IMG SRC="http://ad.doubleclick.net/ad/itk.earthweb.dart/b_soft_dev;abr=!ie;a=b_soft_dev1;sz=468x60;ord=' + ord + '" border=0 height="60" width="468"></A>');
document.write('</IFRAME>');
document.write('</NOLAYER>');
document.write('<ILAYER id="layer1" visibility="hidden" width=468 height=60></ILAYER>');
//-->
</SCRIPT>
			</td>
			<td bgcolor="#003366" nowrap>
<SCRIPT LANGUAGE="javascript">
<!--
document.write('<NOLAYER>');
document.write('<IFRAME SRC="http://ad.doubleclick.net/adi/itk.earthweb.dart/b_soft_dev;a=b_soft_dev4;sz=160x60;ord=' + ord + '" width="160" height="60" frameborder="no" border="0" MARGINWIDTH="0" MARGINHEIGHT="0" SCROLLING="no">');
document.write('<A HREF="http://ad.doubleclick.net/jump/itk.earthweb.dart/b_soft_dev;abr=!ie;a=b_soft_dev4;sz=160x60;ord=' + ord + '" target="_top"><IMG SRC="http://ad.doubleclick.net/ad/itk.earthweb.dart/b_soft_dev;abr=!ie;a=b_soft_dev4;sz=160x60;ord=' + ord + '" border=0 height="60" width="160"></A>');
document.write('</IFRAME>');
document.write('</NOLAYER>');
document.write('<ILAYER id="layer4" visibility="hidden" width=160 height=60></ILAYER>');
//-->
</SCRIPT>
			</td>
			<td bgcolor="#003366" nowrap><a href="ITKN1a2b3c4d5e6f7g8h9idefcon4.html"><img src="/images/dotclear.gif" border="0" height="1" width="1" align="left"></a></td>
			</tr></table><br></td>
	</tr>
		
<!-- 	<tr>
		<td height="1" colspan="3" bgcolor="#003366"><img src="/images/dotclear.gif" border=0 alt=""></td>
	</tr> -->
</table>

<!-- END HEADER -->


<!-- BEGIN SUB HEADER -->

<table bgcolor="#003366" cellpadding="0" cellspacing="0" border="0" width="100%">

<!-- ITK TOPNAV -->
	
	<tr>
		<td align="left" valign="top" nowrap><a href="/index2.html"><img src="/images/top_tabs/home_off.gif" alt="Home" border="0"></a><a href="/pick-account.html"><img src="/images/top_tabs/accountinfo.gif" alt="Account Info" border="0"></a><!--<a href="/PSUser/usrreg.htm?AdminAction=InitAdd&Locale=en&URI=/"><img src="/images/top_tabs/subscribe.gif" alt="Subscribe" border="0"></a>--><a href="/PSUser/psuserauth.htm?cmd=login&URI=/"><img src="/images/top_tabs/login.gif" alt="Login" border="0"></a><a href="/search/"><img src="/images/top_tabs/search.gif" alt="Search" border="0"></a><a href="/PSUser/EWIPOMain.html"><img src="/images/top_tabs/my_itknowledge.gif" alt="My ITKnowledge" border="0"></a><a href="/faq/faq.html"><img src="/images/top_tabs/faq.gif" alt="FAQ" border="0"></a><a href="/sitemap.html"><img src="/images/top_tabs/sitemap.gif" alt="Sitemap" border="0"></a><a href="/contactus.html"><img src="/images/top_tabs/contact_us.gif" alt="Contact Us" border="0"></a></td> 
	</tr>
	
<!-- END of ITK TOPNAV -->

<!-- ITK LOGO and newsletter sign up -->

</table>
	
<table cellpadding="0" cellspacing="0" border="0" width="100%">

	<tr>
		<td align="left" valign="top" nowrap><img src="/images/itk_logo_sm.jpg" alt="" border="0"></td>
		<td align="right"><font face="verdana, sans-serif" size="1">

<script language="JavaScript">
<!-- 

var days = new Array(8);
days[1] = "Sunday";
days[2] = "Monday";
days[3] = "Tuesday";
days[4] = "Wednesday";
days[5] = "Thursday";
days[6] = "Friday";
days[7] = "Saturday";

var months = new Array(13);
months[1] = "January";
months[2] = "February";
months[3] = "March";
months[4] = "April";
months[5] = "May";
months[6] = "June";
months[7] = "July";
months[8] = "August";
months[9] = "September";
months[10] = "October";
months[11] = "November";
months[12] = "December";

var dateObj = new Date()
var wday = days[dateObj.getDay() + 1]
var lmonth = months[dateObj.getMonth() + 1]
var date = dateObj.getDate()
var fyear = dateObj.getYear()
if (fyear <1000) fyear += 1900;
document.write(wday + ", " + lmonth + " " + date + ", " + fyear)
                
//-->
</script>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>
<br><br>


		 </td>
	</tr>
	</table>

<!-- END ITK LOGO and newsletter sign up-->
	
<!-- begin of ITK left NAV -->

<!-- BEGIN LEFT NAVBAR -->

<!-- BEGIN LEFT NAVBAR -->

	<table border="0" cellpadding="0" cellspacing="0">
	
	
		<tr>
		<td width="145" valign="top" align="left" rowspan=8>
		
	<!-- KEYWORD SEARCH -->	
<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//-->
</script>
	
	
	<form name="keyword" method="POST" action="http://ewsearch.earthweb.com:80/jsp/k2search/ewkwk2search_p2.jsp" onSubmit=" return checkForQuery(this); ">
<img src="/images/keyword_searcha.gif" vspace="5" width="145" alt="" border="0">
<INPUT type="hidden" name="collection" value="corpitk_p2">
<INPUT type="hidden" name="altcoll" value="allbooks_p2">
<INPUT type="hidden" name="topics" value="itk_www">
<INPUT type="hidden" name="hl" value="off">
<INPUT name="sortspec" type=hidden value="vspubdate desc score desc">
<INPUT name=fields type=hidden value="vdkvgwkey score vstitle vsauthor vsisbn vspublisher vspubdate">		
<INPUT name=imageprefix type=hidden value="http://www.itknowledge.com">
<INPUT name=ssiFolder type=hidden value="itk">
		
		<table width="145" border="0" cellpadding="0" cellspacing="0">
		<tr>
		<td width="145">&nbsp;&nbsp;<input type="text" name="query" value="" size="11">&nbsp;<input type="image" width=28 height=23 border=0 value="Go" name="Go" src="/images/go.gif" align=absmiddle><br>
&nbsp;&nbsp;<INPUT type="radio" name="scope" value="" checked><FONT face="arial, helvetica" size="1" color="#ffffff" size="1">All ITKnowledge</FONT><br>
&nbsp;&nbsp;<INPUT type="radio" name="scope" value="sourcecode"><FONT face="arial, helvetica" size="1" color="#ffffff" size="1">Source Code</FONT><br>
			<font face="arial, helvetica" size="2">
			<img src="/images/dotclear.gif" width="1" height="5" alt="" border="0"><br>
			
			&nbsp;&nbsp;<a href="/search/search-tips.html"><img src="/images/arrows_blue.gif" alt="" border="0"><font size="1" color="#ffffff">Search Tips</font></a><br>
			&nbsp;&nbsp;<a href="/search/"><img src="/images/arrows_blue.gif" alt="" border="0"><font size="1" color="#ffffff">Advanced Search</font></a><br>
			
			</font>
			
		</td>
		<td width="5"><img src="/images/dotclear.gif" width=5 height=10 hspace="5" alt="" border="0"></td>
		</tr>
		</table>
	</form>
		
		
<!-- BROWSE BY TOPIC -->
		

<form name="meta" method="POST" action="http://ewsearch.earthweb.com:80/jsp/k2search/ewmetak2search_p2.jsp" onSubmit=" return checkForQuery(this); ">
<img src="/images/publication_searcha.gif" width="145" alt="" border="0">
<INPUT type="hidden" name="collection" value="allbooks_p2">
<INPUT type="hidden" name="altcoll" value="corpitk_p2">
<INPUT type="hidden" name="topics" value="itk_www">
<INPUT type="hidden" name="hl" value="off">
<INPUT name="sortspec" type=hidden value="vspubdate desc score desc">
<INPUT name=fields type=hidden value="vdkvgwkey score vstitle vsauthor vspublisher vspubdate">
<INPUT name=imageprefix type=hidden value="http://www.itknowledge.com">
<INPUT name=ssiFolder type=hidden value="itk">
		
<table width="145" border="0" cellpadding="0" cellspacing="0">
	
			<tr>
			<td valign="top">
			&nbsp;&nbsp;<input type="text" name="query" value="" size="11">&nbsp;<input type="image" width=28 height=23 border=0 value="Go" name="Go" src="/images/go.gif" align=absmiddle><br><font face="arial, helvetica" size="2">
			&nbsp;&nbsp;<SELECT NAME="metatags" style="font-size: 12; font-family: sans-serif;" size="1">
			<option value="vstitle" SELECTED>Title
			<option value="vsauthor">Author
			<option value="vspublisher">Publisher
			<option value="vsisbn">ISBN			
			</SELECT><br><br></font>
			</td>
			</tr>
</table>
</form>

<form action="" name="catlist">	
<table width="145" border="0" cellpadding="0" cellspacing="0">				
			<tr>
			<td valign="top">
			<img src="/images/jump_topica.gif" width="145" alt="" border="0">
			</td>
			</tr>
			<tr>
			<td width="145">
				
	        	<font face="Arial,helvetica" size="1">
				&nbsp;&nbsp;<SELECT NAME="cat" onChange='top.location.href=this.options[selectedIndex].value;' style="font-size: 10; font-family: sans-serif;">
                        <option value="" selected>Please Select
                        <option value="">-----------
						<option value="/reference/dir.1-busman.html">Business &amp; IT Mgmt
						<option value="/reference/dir.2-certification.html">Certification &amp; Training                       
						<option value="/reference/dir.3-databaseanderp.html">Database &amp; ERP
                        <option value="/reference/dir.4-desktopapps.html">Desktop Apps
                        <option value="/reference/dir.5-desktoppubanddesign.html">Graphic Design
                        <option value="/reference/dir.6-generalinternet.html">General Internet
                        <option value="/reference/dir.7-hardwareandos.html">Hardware &amp; OS
                        <option value="/reference/dir.8-ibmredbooks.html">IBM RedBooks
                        <option value="/reference/dir.9-networktelcom.html">Network &amp; Telecom
						<option value="/reference/dir.10-websoftwaredev.html">Web &amp; Software Dev
                        <option value="">-----------

                        <option value="/reference/dir.archive1.html">Public Archive               
                        </SELECT>
			</font>
			
		</td>
		</tr>
	</table>
	</form>
	
<!-- LEFT NAV SEARCH END -->

	</td>
		

<!-- END LEFT NAVBAR -->


<!-- END LEFT NAVBAR -->
	
	<td width="15"><img src="/images/dotclear.gif" width="15" alt="" border="0"></td>

<!-- end of ITK left NAV -->

<!-- begin main content -->
	
	<td width="100%" valign="top" align="left">
		<br>

<!-- END SUB HEADER -->
<!-- Created by dB Page Builder.  http://www.pchelponline.com/bluestem -->

<!--Begin Content Column -->

<TABLE border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img src="/images/sm_covers/1576104265.gif" width=60 height=73 alt="Perl Core Language Little Black Book" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Perl Core Language Little Black Book</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Steven Holzner</i>
    <br>
    The Coriolis Group
    <br>
    <b>ISBN:</b>&nbsp;1576104265<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;03/01/99</font>&nbsp;&nbsp;<A HREF="http://www.digitalguru.com/dgstore/product.asp?isbn=1576104265&ac%5Fid=28" TARGET="anotherwindows"><img src="/images/buyit.gif" width=64 height=23 hspace="5" align="middle" alt="Buy It" border="0"></a><a href="/PSUser/EWBookMarks.html?url=http://www.itknowledge.com/reference/standard/1576104265/ewtoc.html&isbn=1576104265"><img src="/images/bookmarkit.gif" border=0 align="middle" alt="Bookmark It" width=97 height=23></a>
</td>
</tr>
</table>
<P>
<FORM name= "search2" method="POST" action="http://ewsearch.earthweb.com:80/jsp/k2search/ewintrak2search_p2.jsp" onSubmit=" return checkForQuery(this); ">
<INPUT type="hidden" name="collection" value="corpitk_p2">
<INPUT type="hidden" name="altcoll" value="allbooks_p2">
<INPUT type="hidden" name="hl" value="off">
<INPUT name="sortspec" type=hidden value="score desc">
<INPUT name="fields" type=hidden value="vdkvgwkey score vstitle vsisbn vsauthor vspublisher vspubdate">
<INPUT name="imageprefix" type=hidden value="http://www.itknowledge.com">
<INPUT name="ssiFolder" type=hidden value="itk">
<INPUT name="topics" type=hidden value="itk_www">
<INPUT type="hidden" name="bookid" value="t_1576104265">
<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="query" size=25 VALUE="">&nbsp;<input type="image" width=28 height=23 border=0 value="Go" name="Go" src="/images/go.gif" align=absmiddle>

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=1576104265//-->
<!--TITLE=Perl Core Language Little Black Book//-->
<!--AUTHOR=Steven Holzner//-->
<!--PUBLISHER=The Coriolis Group//-->
<!--CHAPTER=11//-->
<!--PAGES=257-260//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="11-03.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="../ch12/12-01.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<H4 ALIGN="LEFT"><A NAME="Heading24"></A><FONT COLOR="#000077">IPC: Sending A Signal To Another Process</FONT></H4>
<P>Processes in Unix can communicate using <I>signals</I>. To see what signals are supported on a particular Unix system, you can use the <B>kill -l</B> command:</P>
<!-- CODE SNIP //-->
<PRE>
%kill -l

HUP INT QUIT ILL TRAP ABRT EMT FPE KILL BUS SEGV SYS PIPE
ALRM TERM URG STOP TSTP CONT CHLD TTIN TTOU IO XCPU
XFSZ VTALRM PROF WINCH LOST USR1 USR2
</PRE>
<!-- END CODE SNIP //-->
<P>Perl allows you to catch these signals by connecting handler functions to them using the special hash %<B>SIG</B>. There&#146;s a key in that hash for each signal you can use.</P>
<P>Here&#146;s an example. In this case, we&#146;ll fork and create a child process, and we&#146;ll have the child process send an <B>INT</B> signal back to the parent. Here&#146;s how we create the child process:</P>
<!-- CODE SNIP //-->
<PRE>
if (open(CHILDHANDLE, &#147;|-&#148;))
</PRE>
<!-- END CODE SNIP //-->
<P>Next, we add a signal handler for the <B>INT</B> signal: an anonymous subroutine that displays a message when we get that signal:</P>
<!-- CODE SNIP //-->
<PRE>
if (open(CHILDHANDLE, &#147;|-&#148;)) {
    $SIG{INT} = sub {print &#147;Got the message.\n&#148;};
</PRE>
<!-- END CODE SNIP //-->
<P>The child process will need the parent&#146;s process ID&#151;which is stored in the Perl special variable <B>$$</B>&#151;to send a signal to the parent, so we pass that process ID to the child:</P>
<!-- CODE SNIP //-->
<PRE>
if (open(CHILDHANDLE, &#147;|-&#148;)) {
    $SIG{INT} = sub {print &#147;Got the message.\n&#148;};
    print CHILDHANDLE &#147;$$&#148;;
    close(CHILDHANDLE);
</PRE>
<!-- END CODE SNIP //-->
<P>In the child process, we store the parent&#146;s process ID as <B>$parentid</B>, and send the <B>INT</B> signal to the parent using the <B>kill</B> function:</P>
<!-- CODE //-->
<PRE>
if (open(CHILDHANDLE, &#147;|-&#148;)) {
    $SIG{INT} = sub {print &#147;Got the message.\n&#148;};
    print CHILDHANDLE &#147;$$&#148;;
    close(CHILDHANDLE);
} else {
    chomp($parentpid = &lt;&gt;);
    kill INT =&gt; $parentpid;
    exit;
}
</PRE>
<!-- END CODE //-->
<P>And that&#146;s it; here&#146;s the result, printed by the parent process after it gets the <B>INT</B> signal from the child:</P>
<!-- CODE SNIP //-->
<PRE>
Got the message.
</PRE>
<!-- END CODE SNIP //-->
<TABLE WIDTH="100%" BORDER RULES="ROWS">
<TR>
<TH WIDTH="80%" ALIGN="LEFT" VALIGN="TOP"><I>Related solution:</I>
<TH ALIGN="RIGHT" VALIGN="TOP"><I>Found on page:</I>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><B>open</B> Open A File
<TD VALIGN="TOP" ALIGN="RIGHT">265
</TABLE>
<H4 ALIGN="LEFT"><A NAME="Heading25"></A><FONT COLOR="#000077">IPC: Using Sockets</FONT></H4>
<P>Sockets allow you to form connections over the Internet (as well as locally). This is too big a topic to cover in depth in the space we have, but you can get some indication of the power of sockets here.
</P>
<P>In this case, I&#146;ll write an example using the UDP protocol in which a client program writes to a server across the Internet. Although you can run the client program from any Internet-connected machine (such as a home PC), the server program should be running on an Internet service provider (ISP).</P>
<P>We start the client program by importing IO::Socket from the Perl IO module:</P>
<!-- CODE SNIP //-->
<PRE>
use IO::Socket;
</PRE>
<!-- END CODE SNIP //-->
<P>Next, we create a socket with <B>IO::Socket::INET-&gt;new</B>, passing that method the settings for the protocol we&#146;ll use (UDP), the port we want to access on the server (we&#146;ll use an arbitrary value, 4321, here; note that on Unix machines, ports below 1024 are reserved for system use), and the name of the ISP:</P>
<!-- CODE SNIP //-->
<PRE>
use IO::Socket;
$socket = IO::Socket::INET-&gt;new(Proto =&gt; &#145;udp&#146;,
        PeerPort  =&gt; 4321,
        PeerAddr  =&gt; &#145;servername.com&#146;);
</PRE>
<!-- END CODE SNIP //-->
<P>All that&#146;s left is to send some data to the server, and we do that with the <B>send</B> method:</P>
<!-- CODE SNIP //-->
<PRE>
use IO::Socket;
$socket = IO::Socket::INET-&gt;new(Proto =&gt; &#145;udp&#146;,
        PeerPort  =&gt; 4321,
        PeerAddr  =&gt; &#145;servername.com&#146;);
$socket-&gt;send(&#145;Hello!&#146;);
</PRE>
<!-- END CODE SNIP //-->
<P>Now I&#146;ll write the server program. This program should be running when you send a message with the client program, so we&#146;ll start by adding IO::Socket and printing out the message <B>&#147;Waiting...\n&#148;</B>:</P>
<!-- CODE SNIP //-->
<PRE>
use IO::Socket;
print &#147;Waiting...\n&#148;;
</PRE>
<!-- END CODE SNIP //-->
<P>We create the socket on the server with <B>IO::Socket::INET-&gt;new</B>, indicating that we want to use the UDP protocol and giving the port number we want to use:</P>
<!-- CODE SNIP //-->
<PRE>
use IO::Socket;
print &#147;Waiting...\n&#148;;
$socket = IO::Socket::INET-&gt;new(LocalPort =&gt; 4321,
        Proto =&gt; &#145;udp&#146;);
</PRE>
<!-- END CODE SNIP //-->
<P>To actually receive data from the client, we use the <B>$socket</B> object&#146;s <B>recv</B> method, indicating that we want to receive a maximum of 128 bytes. This method will wait for data, and after the data appears, we display that data by printing it:</P>
<!-- CODE SNIP //-->
<PRE>
use IO::Socket;
print &#147;Waiting...\n&#148;;
$socket = IO::Socket::INET-&gt;new(LocalPort =&gt; 4321,
        Proto =&gt; &#145;udp&#146;);
$socket-&gt;recv($text, 128);
print &#147;Got this message: $text\n&#148;;
</PRE>
<!-- END CODE SNIP //-->
<P>Here&#146;s the result you see from the server program when the client program is run:
</P>
<!-- CODE SNIP //-->
<PRE>
Waiting...
Got this message: Hello!
</PRE>
<!-- END CODE SNIP //-->
<H4 ALIGN="LEFT"><A NAME="Heading26"></A><FONT COLOR="#000077">IPC: Win32 OLE Automation</FONT></H4>
<P>One common method of IPC in Windows is to use OLE automation servers (also called code components). The ActiveState Perl for Win32 supports OLE automation; to use OLE automation, you create an object in your program from an OLE automation server like Microsoft Excel. After the object is created, you&#146;re free to use that object&#146;s methods.
</P>
<P>When communicating between processes in Windows, data types become an issue&#151;imagine, for example, if your program was written in C<SMALL>&#43;&#43;</SMALL> and you&#146;re communicating with a program written in Pascal. To get around such translation problems, the Perl Win32 package defines a set of standard variants (variants provide a convenient way of holding essentially untyped data), as shown in Table 11.1. That table indicates the OLE types that Perl data types are translated into before being passed to the OLE automation server.</P>
<CAPTION ALIGN="LEFT" COLSPAN="2"><B><I>Table 11.1 OLE automation data types.</I></B>
<TABLE WIDTH="100%" BORDER RULES="ROWS">
<TR>
<TH WIDTH="50%" ALIGN="LEFT">OLE Data Type
<TH ALIGN="LEFT">Standard Data Type
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><B>OLE::VT_BOOL</B>
<TD VALIGN="TOP" ALIGN="LEFT">OLE Boolean
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><B>OLE::VT_BSTR</B>
<TD VALIGN="TOP" ALIGN="LEFT">OLE string (C-style char*)
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><B>OLE::VT_CY</B>
<TD VALIGN="TOP" ALIGN="LEFT">OLE currency
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><B>OLE::VT_DATE</B>
<TD VALIGN="TOP" ALIGN="LEFT">OLE date
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><B>OLE::VT_I2</B>
<TD VALIGN="TOP" ALIGN="LEFT">Signed integer (2 bytes)
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><B>OLE::VT_I4</B>
<TD VALIGN="TOP" ALIGN="LEFT">Signed integer (4 bytes)
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><B>OLE::VT_R4F</B>
<TD VALIGN="TOP" ALIGN="LEFT">loating point (4 bytes)
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><B>OLE::VT_R8F</B>
<TD VALIGN="TOP" ALIGN="LEFT">loating point (8 bytes)
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><B>OLE::VT_UI1</B>
<TD VALIGN="TOP" ALIGN="LEFT">Unsigned character
</TABLE>
<P>For example, a value stored as an integer in Perl would be translated into a <B>VT_I4</B> variant; a double into a <B>VT_R8</B> variant, and so on. The Perl Win32 package takes care of this automatically.</P>
<P>To create an OLE automation object in your program, you include the OLE module:</P>
<!-- CODE SNIP //-->
<PRE>
use OLE;
</PRE>
<!-- END CODE SNIP //-->
<P>Then you use the <B>CreateObject</B> function to create an OLE automation object. Let&#146;s look at an example. Here, we will use Microsoft Excel to add 2 &#43; 2 and then we&#146;ll display the result. We start by storing those values as <B>$operand1</B> and <B>$operand2</B>:</P>
<!-- CODE SNIP //-->
<PRE>
use OLE;
$operand1 = &#145;2&#146;;
$operand2 = &#145;2&#146;;
</PRE>
<!-- END CODE SNIP //-->
<P>Next, we create an OLE automation object named <B>$excelobject</B> with <B>CreateObject</B>. You pass this function the value <B>OLE</B> and indicate the type of OLE automation object you want to create like this: <B>&#145;server.class&#146;</B>, in which server is the registered name of the OLE automation server and class is the class of the object you want to create. (OLE automation servers typically support many different classes&#151;if you&#146;re lucky, your server&#146;s documentation will spell out what methods you can use in what class; Excel&#146;s documentation does, which is why we&#146;re using Excel in this example.) In this case, we&#146;ll create an Excel worksheet this way:</P>
<!-- CODE SNIP //-->
<PRE>
use OLE;
$operand1 = &#145;2&#146;;
$operand2 = &#145;2&#146;;
$excelobject = CreateObject OLE &#145;Excel.Sheet&#146;;
</PRE>
<!-- END CODE SNIP //-->
<P>Now we&#146;re free to use this new object&#146;s methods. Here, we&#146;ll load <B>$operand1</B> into the spreadsheet&#146;s cell (1, 1), <B>$operand2</B> into cell (2, 1), and use an Excel formula to add the two values, placing the result in cell (3, 1):</P>
<!-- CODE SNIP //-->
<PRE>
use OLE;
$operand1 = &#145;2&#146;;
$operand2 = &#145;2&#146;;
$excelobject = CreateObject OLE &#145;Excel.Sheet&#146;;
$excelobject-&gt;Cells(1,1)-&gt;{Value} = $operand1;
$excelobject-&gt;Cells(2,1)-&gt;{Value} = $operand2;
$excelobject-&gt;Cells(3,1)-&gt;{Formula} = &#145;=R1C1 &#43; R2C1&#146;;
</PRE>
<!-- END CODE SNIP //-->
<P>All that&#146;s left is to display the sum and quit:
</P>
<!-- CODE //-->
<PRE>
use OLE;
$operand1 = &#145;2&#146;;
$operand2 = &#145;2&#146;;
$excelobject = CreateObject OLE &#145;Excel.Sheet&#146;;
$excelobject-&gt;Cells(1,1)-&gt;{Value} = $operand1;
$excelobject-&gt;Cells(2,1)-&gt;{Value} = $operand2;
$excelobject-&gt;Cells(3,1)-&gt;{Formula} = &#145;=R1C1 &#43; R2C1&#146;;
$sum = $excelobject-&gt;Cells(3,1)-&gt;{Value};
$excelobject-&gt;Quit();
print &#147;According to Microsoft Excel, &#148;,
    &#147;$operand1 &#43; $operand2 = $sum.\n&#148;;

According to Microsoft Excel, 2 &#43; 2 = 4.
</PRE>
<!-- END CODE //-->
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="11-03.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="../ch12/12-01.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>

<hr width="90%" size="1" noshade>
<div align="center">
<font face="Verdana,sans-serif" size="1">Copyright &copy; <a href="/reference/tcg00001.html">The Coriolis Group, Inc.</a></font>
</div>
<!-- all of the reference materials (books) have the footer and subfoot reveresed -->
<!-- reference_subfoot = footer -->
<!-- reference_footer = subfoot -->

<!-- BEGIN SUB FOOTER -->
	<br>
	<img src="/images/dotclear.gif" width="5" height="7" border="0">
	</TD>
    </TR>
	</TABLE>
	
	<table width="100%" border=0 cellpadding=0 cellspacing=0>
	<tr>
		<td align="left" width="160"><img src="/images/bot_curve.jpg" width="160" alt="" border="0"></td>
		<td align="left" valign="top" nowrap><a href="/index2.html"><img src="/images/top_tabs/home_bot.gif" alt="Home" border="0"></a><a href="/pick-account.html"><img src="/images/top_tabs/account_info_bot.gif" alt="Account Info" border="0"></a><a href="/PSUser/usrreg.htm?AdminAction=InitAdd&Locale=en&URI=/"><img src="/images/top_tabs/subscribe_bot.gif" alt="Subscribe" border="0"></a><a href="/PSUser/psuserauth.htm?cmd=login&URI=/"><img src="/images/top_tabs/login_bot.gif" alt="Login" border="0"></a><a href="/search/"><img src="/images/top_tabs/search_bot.gif" alt="Search" border="0"></a><a href="/PSUser/EWIPOMain.html"><img src="/images/top_tabs/my_itknowledge_bot.gif" alt="My ITKnowledge" border="0"></a><a href="/faq/faq.html"><img src="/images/top_tabs/faq_bot.gif" alt="FAQ" border="0"></a><a href="/sitemap.html"><img src="/images/top_tabs/sitemap_bot.gif" alt="Sitemap" border="0"></a><a href="/contactus.html"><img src="/images/top_tabs/contact_us_bot.gif" alt="Contact Us" border="0"></a></td> 
	</tr>
	</table>
		
	<table width="100%" bgcolor="#003366" border=0 cellpadding=0 cellspacing=0>
	<tr>
		<td align="left" width=145><img src="/images/clear_pixel.gif" width=145 height="1" alt="" border="0"></td>
				
<!-- END SUB FOOTER -->

<!-- all of the books have the footer and subfoot reveresed -->
<!-- reference_subfoot = footer -->
<!-- reference_footer = subfoot -->

<!-- FOOTER -->
			
<td align="left" bgcolor="#003366">
<table border="0" cellspacing="10" cellpadding="5">
<tr>
<td align="center">
<font face="arial, helvetica" size="1" color="#cccccc"><b><a href="/products.html"><font color="#0099CC">Products</font></a>&nbsp;|&nbsp; <a href="/contactus.html"><font color="#0099CC">Contact Us</font></a>&nbsp;|&nbsp; <a href="http://www.earthweb.com/dlink.corp|about_us-jhtml.72.0.-.0.jhtml" target="resource window"><font color="#0099CC">About Us</font></a>&nbsp;|&nbsp; <a href="http://www.earthweb.com/dlink.corp|privacy-jhtml.72.0.-.-.jhtml" target="resource window"><font color="#0099CC">Privacy</font></a> &nbsp;|&nbsp; <a href="http://www.itmarketer.com/" target="resource window"><font color="#0099CC">Ad Info</font></a> &nbsp;|&nbsp; <a href="/index2.html"><font color="#0099CC">Home</font></a></b>
<br><br>Use of this site is subject to certain <a href="/agreement.html"><font color="#0099CC">Terms &amp; Conditions</font></a>, <a href="/copyright.html"><font color="#0099CC">Copyright &copy; 1996-2000 EarthWeb Inc.</font></a> All rights reserved.  Reproduction in whole or in part in any form or medium without express written <a href="http://www.earthweb.com/dlink.corp|permissions-jhtml.72.0.-.-.jhtml" target="resource window"><font color="#0099CC">permission</font></a> of EarthWeb is prohibited. Read EarthWeb's <A HREF="http://www.earthweb.com/dlink.corp|privacy-jhtml.72.0.-.-.jhtml" target="resource window"><font color="#0099CC">privacy</font></A> statement.</font><br><br>
</td>
</tr>
</table>

<!-- netranger link to stop spiders -->

<a href="ITKN1a2b3c4d5e6f7g8h9idefcon4.html">
<img src="/images/dotclear.gif" border="0" height="1" width="1" align="left"></a>
</td>
		</tr>
</table>
<SCRIPT LANGUAGE="javascript">
<!--
document.write('<LAYER SRC="http://ad.doubleclick.net/adl/itk.earthweb.dart/b_soft_dev;a=b_soft_dev1;sz=468x60;ord=' + ord + '" width=468 height=60 visibility="hidden" onLoad="moveToAbsolute(layer1.pageX,layer1.pageY);clip.height=60;clip.width=468; visibility=\'show\';"></LAYER>');
document.write('<LAYER SRC="http://ad.doubleclick.net/adl/itk.earthweb.dart/b_soft_dev;a=b_soft_dev4;sz=160x60;ord=' + ord + '" width=160 height=60 visibility="hidden" onLoad="moveToAbsolute(layer4.pageX,layer4.pageY);clip.height=60;clip.width=160; visibility=\'show\';"></LAYER>');
document.write('<LAYER SRC="http://ad.doubleclick.net/adl/itk.earthweb.dart/b_soft_dev;a=b_soft_dev3;sz=125x125;ord=' + ord + '" width=125 height=125 visibility="hidden" onLoad="moveToAbsolute(layer3.pageX,layer3.pageY);clip.height=125;clip.width=125; visibility=\'show\';"></LAYER>');
//-->
</SCRIPT>
</BODY>
</HTML>

<!-- END FOOTER -->

