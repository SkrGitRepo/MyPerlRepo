<HTML>
<HEAD>
<META name=vsisbn content="1576104265">
<META name=vstitle content="Perl Core Language Little Black Book">
<META name=vsauthor content="Steven Holzner">
<META name=vspublisher content="The Coriolis Group">
<META name=vspubdate content="03/01/99">
<META name=vscategory content="Web and Software Development: Open Source Development: Languages: Perl,Web and Software Development: Programming, Scripting, and Markup Languages: Perl">





<TITLE>Perl Core Language Little Black Book:CGI: Web Counters, Guest Books, Emailers, And Secure Scripts</TITLE>

<!-- HEADER -->

<STYLE type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
</STYLE>

<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
         var Win = window.open(url,"displayWindow",'width=' + width +',height=' + height + ',resizable=1,scrollbars=yes');
	if (Win) {
		Win.focus();
	}
}
//-->
</script>
<SCRIPT>
<!--
function popUp(url) {
        var Win = window.open(url,"displayWindow",'width=400,height=300,resizable=1,scrollbars=yes');
	if (Win) {
		Win.focus();
	}
}
//-->
</SCRIPT>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//-->
</script>

<SCRIPT LANGUAGE="JavaScript">
<!--
var axel = Math.random() + "";
var ord = axel * 1000000000000000000 + "?";

//This part of script alleviates a Netscape document.write bug
<!-- 
NS4 = document.layers;
if (NS4) {
origWidth = innerWidth;
origHeight = innerHeight;
}
function reDo() {
if (innerWidth != origWidth || innerHeight != origHeight) 
location.reload();
}
if (NS4) onresize = reDo;
//-->
</SCRIPT> 
</HEAD>

<body background="/images/back.jpg" bgcolor="#FFFFFF" link="#003399" alink="#FF0000" vlink="#003399" topmargin=0 leftmargin=0 marginheight=0 marginwidth=0>

<table bgcolor="#003366" width="100%" border="0" cellpadding="0" cellspacing="0">
	<tr valign="top">
		<td height="95">
		&nbsp;&nbsp;<a href="http://www.earthweb.com" target="resource window"><img src="/images/ew_logo.jpg" width="82" height="58" alt="EarthWeb" border="0"></a>&nbsp;&nbsp;&nbsp;</td>
		<td height=95">
		<table width="100%">
			<tr valign="top">
			<td bgcolor="#003366" nowrap>
<SCRIPT LANGUAGE="javascript">
<!--
document.write('<NOLAYER>');
document.write('<IFRAME SRC="http://ad.doubleclick.net/adi/itk.earthweb.dart/b_soft_dev;a=b_soft_dev1;sz=468x60;ord=' + ord + '" width="468" height="60" frameborder="no" border="0" MARGINWIDTH="0" MARGINHEIGHT="0" SCROLLING="no">');
document.write('<A HREF="http://ad.doubleclick.net/jump/itk.earthweb.dart/b_soft_dev;abr=!ie;a=b_soft_dev1;sz=468x60;ord=' + ord + '" target="_top"><IMG SRC="http://ad.doubleclick.net/ad/itk.earthweb.dart/b_soft_dev;abr=!ie;a=b_soft_dev1;sz=468x60;ord=' + ord + '" border=0 height="60" width="468"></A>');
document.write('</IFRAME>');
document.write('</NOLAYER>');
document.write('<ILAYER id="layer1" visibility="hidden" width=468 height=60></ILAYER>');
//-->
</SCRIPT>
			</td>
			<td bgcolor="#003366" nowrap>
<SCRIPT LANGUAGE="javascript">
<!--
document.write('<NOLAYER>');
document.write('<IFRAME SRC="http://ad.doubleclick.net/adi/itk.earthweb.dart/b_soft_dev;a=b_soft_dev4;sz=160x60;ord=' + ord + '" width="160" height="60" frameborder="no" border="0" MARGINWIDTH="0" MARGINHEIGHT="0" SCROLLING="no">');
document.write('<A HREF="http://ad.doubleclick.net/jump/itk.earthweb.dart/b_soft_dev;abr=!ie;a=b_soft_dev4;sz=160x60;ord=' + ord + '" target="_top"><IMG SRC="http://ad.doubleclick.net/ad/itk.earthweb.dart/b_soft_dev;abr=!ie;a=b_soft_dev4;sz=160x60;ord=' + ord + '" border=0 height="60" width="160"></A>');
document.write('</IFRAME>');
document.write('</NOLAYER>');
document.write('<ILAYER id="layer4" visibility="hidden" width=160 height=60></ILAYER>');
//-->
</SCRIPT>
			</td>
			<td bgcolor="#003366" nowrap><a href="ITKN1a2b3c4d5e6f7g8h9idefcon4.html"><img src="/images/dotclear.gif" border="0" height="1" width="1" align="left"></a></td>
			</tr></table><br></td>
	</tr>
		
<!-- 	<tr>
		<td height="1" colspan="3" bgcolor="#003366"><img src="/images/dotclear.gif" border=0 alt=""></td>
	</tr> -->
</table>

<!-- END HEADER -->


<!-- BEGIN SUB HEADER -->

<table bgcolor="#003366" cellpadding="0" cellspacing="0" border="0" width="100%">

<!-- ITK TOPNAV -->
	
	<tr>
		<td align="left" valign="top" nowrap><a href="/index2.html"><img src="/images/top_tabs/home_off.gif" alt="Home" border="0"></a><a href="/pick-account.html"><img src="/images/top_tabs/accountinfo.gif" alt="Account Info" border="0"></a><!--<a href="/PSUser/usrreg.htm?AdminAction=InitAdd&Locale=en&URI=/"><img src="/images/top_tabs/subscribe.gif" alt="Subscribe" border="0"></a>--><a href="/PSUser/psuserauth.htm?cmd=login&URI=/"><img src="/images/top_tabs/login.gif" alt="Login" border="0"></a><a href="/search/"><img src="/images/top_tabs/search.gif" alt="Search" border="0"></a><a href="/PSUser/EWIPOMain.html"><img src="/images/top_tabs/my_itknowledge.gif" alt="My ITKnowledge" border="0"></a><a href="/faq/faq.html"><img src="/images/top_tabs/faq.gif" alt="FAQ" border="0"></a><a href="/sitemap.html"><img src="/images/top_tabs/sitemap.gif" alt="Sitemap" border="0"></a><a href="/contactus.html"><img src="/images/top_tabs/contact_us.gif" alt="Contact Us" border="0"></a></td> 
	</tr>
	
<!-- END of ITK TOPNAV -->

<!-- ITK LOGO and newsletter sign up -->

</table>
	
<table cellpadding="0" cellspacing="0" border="0" width="100%">

	<tr>
		<td align="left" valign="top" nowrap><img src="/images/itk_logo_sm.jpg" alt="" border="0"></td>
		<td align="right"><font face="verdana, sans-serif" size="1">

<script language="JavaScript">
<!-- 

var days = new Array(8);
days[1] = "Sunday";
days[2] = "Monday";
days[3] = "Tuesday";
days[4] = "Wednesday";
days[5] = "Thursday";
days[6] = "Friday";
days[7] = "Saturday";

var months = new Array(13);
months[1] = "January";
months[2] = "February";
months[3] = "March";
months[4] = "April";
months[5] = "May";
months[6] = "June";
months[7] = "July";
months[8] = "August";
months[9] = "September";
months[10] = "October";
months[11] = "November";
months[12] = "December";

var dateObj = new Date()
var wday = days[dateObj.getDay() + 1]
var lmonth = months[dateObj.getMonth() + 1]
var date = dateObj.getDate()
var fyear = dateObj.getYear()
if (fyear <1000) fyear += 1900;
document.write(wday + ", " + lmonth + " " + date + ", " + fyear)
                
//-->
</script>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>
<br><br>


		 </td>
	</tr>
	</table>

<!-- END ITK LOGO and newsletter sign up-->
	
<!-- begin of ITK left NAV -->

<!-- BEGIN LEFT NAVBAR -->

<!-- BEGIN LEFT NAVBAR -->

	<table border="0" cellpadding="0" cellspacing="0">
	
	
		<tr>
		<td width="145" valign="top" align="left" rowspan=8>
		
	<!-- KEYWORD SEARCH -->	
<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//-->
</script>
	
	
	<form name="keyword" method="POST" action="http://ewsearch.earthweb.com:80/jsp/k2search/ewkwk2search_p2.jsp" onSubmit=" return checkForQuery(this); ">
<img src="/images/keyword_searcha.gif" vspace="5" width="145" alt="" border="0">
<INPUT type="hidden" name="collection" value="corpitk_p2">
<INPUT type="hidden" name="altcoll" value="allbooks_p2">
<INPUT type="hidden" name="topics" value="itk_www">
<INPUT type="hidden" name="hl" value="off">
<INPUT name="sortspec" type=hidden value="vspubdate desc score desc">
<INPUT name=fields type=hidden value="vdkvgwkey score vstitle vsauthor vsisbn vspublisher vspubdate">		
<INPUT name=imageprefix type=hidden value="http://www.itknowledge.com">
<INPUT name=ssiFolder type=hidden value="itk">
		
		<table width="145" border="0" cellpadding="0" cellspacing="0">
		<tr>
		<td width="145">&nbsp;&nbsp;<input type="text" name="query" value="" size="11">&nbsp;<input type="image" width=28 height=23 border=0 value="Go" name="Go" src="/images/go.gif" align=absmiddle><br>
&nbsp;&nbsp;<INPUT type="radio" name="scope" value="" checked><FONT face="arial, helvetica" size="1" color="#ffffff" size="1">All ITKnowledge</FONT><br>
&nbsp;&nbsp;<INPUT type="radio" name="scope" value="sourcecode"><FONT face="arial, helvetica" size="1" color="#ffffff" size="1">Source Code</FONT><br>
			<font face="arial, helvetica" size="2">
			<img src="/images/dotclear.gif" width="1" height="5" alt="" border="0"><br>
			
			&nbsp;&nbsp;<a href="/search/search-tips.html"><img src="/images/arrows_blue.gif" alt="" border="0"><font size="1" color="#ffffff">Search Tips</font></a><br>
			&nbsp;&nbsp;<a href="/search/"><img src="/images/arrows_blue.gif" alt="" border="0"><font size="1" color="#ffffff">Advanced Search</font></a><br>
			
			</font>
			
		</td>
		<td width="5"><img src="/images/dotclear.gif" width=5 height=10 hspace="5" alt="" border="0"></td>
		</tr>
		</table>
	</form>
		
		
<!-- BROWSE BY TOPIC -->
		

<form name="meta" method="POST" action="http://ewsearch.earthweb.com:80/jsp/k2search/ewmetak2search_p2.jsp" onSubmit=" return checkForQuery(this); ">
<img src="/images/publication_searcha.gif" width="145" alt="" border="0">
<INPUT type="hidden" name="collection" value="allbooks_p2">
<INPUT type="hidden" name="altcoll" value="corpitk_p2">
<INPUT type="hidden" name="topics" value="itk_www">
<INPUT type="hidden" name="hl" value="off">
<INPUT name="sortspec" type=hidden value="vspubdate desc score desc">
<INPUT name=fields type=hidden value="vdkvgwkey score vstitle vsauthor vspublisher vspubdate">
<INPUT name=imageprefix type=hidden value="http://www.itknowledge.com">
<INPUT name=ssiFolder type=hidden value="itk">
		
<table width="145" border="0" cellpadding="0" cellspacing="0">
	
			<tr>
			<td valign="top">
			&nbsp;&nbsp;<input type="text" name="query" value="" size="11">&nbsp;<input type="image" width=28 height=23 border=0 value="Go" name="Go" src="/images/go.gif" align=absmiddle><br><font face="arial, helvetica" size="2">
			&nbsp;&nbsp;<SELECT NAME="metatags" style="font-size: 12; font-family: sans-serif;" size="1">
			<option value="vstitle" SELECTED>Title
			<option value="vsauthor">Author
			<option value="vspublisher">Publisher
			<option value="vsisbn">ISBN			
			</SELECT><br><br></font>
			</td>
			</tr>
</table>
</form>

<form action="" name="catlist">	
<table width="145" border="0" cellpadding="0" cellspacing="0">				
			<tr>
			<td valign="top">
			<img src="/images/jump_topica.gif" width="145" alt="" border="0">
			</td>
			</tr>
			<tr>
			<td width="145">
				
	        	<font face="Arial,helvetica" size="1">
				&nbsp;&nbsp;<SELECT NAME="cat" onChange='top.location.href=this.options[selectedIndex].value;' style="font-size: 10; font-family: sans-serif;">
                        <option value="" selected>Please Select
                        <option value="">-----------
						<option value="/reference/dir.1-busman.html">Business &amp; IT Mgmt
						<option value="/reference/dir.2-certification.html">Certification &amp; Training                       
						<option value="/reference/dir.3-databaseanderp.html">Database &amp; ERP
                        <option value="/reference/dir.4-desktopapps.html">Desktop Apps
                        <option value="/reference/dir.5-desktoppubanddesign.html">Graphic Design
                        <option value="/reference/dir.6-generalinternet.html">General Internet
                        <option value="/reference/dir.7-hardwareandos.html">Hardware &amp; OS
                        <option value="/reference/dir.8-ibmredbooks.html">IBM RedBooks
                        <option value="/reference/dir.9-networktelcom.html">Network &amp; Telecom
						<option value="/reference/dir.10-websoftwaredev.html">Web &amp; Software Dev
                        <option value="">-----------

                        <option value="/reference/dir.archive1.html">Public Archive               
                        </SELECT>
			</font>
			
		</td>
		</tr>
	</table>
	</form>
	
<!-- LEFT NAV SEARCH END -->

	</td>
		

<!-- END LEFT NAVBAR -->


<!-- END LEFT NAVBAR -->
	
	<td width="15"><img src="/images/dotclear.gif" width="15" alt="" border="0"></td>

<!-- end of ITK left NAV -->

<!-- begin main content -->
	
	<td width="100%" valign="top" align="left">
		<br>

<!-- END SUB HEADER -->
<!-- Created by dB Page Builder.  http://www.pchelponline.com/bluestem -->

<!--Begin Content Column -->

<TABLE border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img src="/images/sm_covers/1576104265.gif" width=60 height=73 alt="Perl Core Language Little Black Book" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Perl Core Language Little Black Book</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Steven Holzner</i>
    <br>
    The Coriolis Group
    <br>
    <b>ISBN:</b>&nbsp;1576104265<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;03/01/99</font>&nbsp;&nbsp;<A HREF="http://www.digitalguru.com/dgstore/product.asp?isbn=1576104265&ac%5Fid=28" TARGET="anotherwindows"><img src="/images/buyit.gif" width=64 height=23 hspace="5" align="middle" alt="Buy It" border="0"></a><a href="/PSUser/EWBookMarks.html?url=http://www.itknowledge.com/reference/standard/1576104265/ewtoc.html&isbn=1576104265"><img src="/images/bookmarkit.gif" border=0 align="middle" alt="Bookmark It" width=97 height=23></a>
</td>
</tr>
</table>
<P>
<FORM name= "search2" method="POST" action="http://ewsearch.earthweb.com:80/jsp/k2search/ewintrak2search_p2.jsp" onSubmit=" return checkForQuery(this); ">
<INPUT type="hidden" name="collection" value="corpitk_p2">
<INPUT type="hidden" name="altcoll" value="allbooks_p2">
<INPUT type="hidden" name="hl" value="off">
<INPUT name="sortspec" type=hidden value="score desc">
<INPUT name="fields" type=hidden value="vdkvgwkey score vstitle vsisbn vsauthor vspublisher vspubdate">
<INPUT name="imageprefix" type=hidden value="http://www.itknowledge.com">
<INPUT name="ssiFolder" type=hidden value="itk">
<INPUT name="topics" type=hidden value="itk_www">
<INPUT type="hidden" name="bookid" value="t_1576104265">
<font face="arial, helvetica" size=2><b>Search this book:</b></font><br>
<INPUT NAME="query" size=25 VALUE="">&nbsp;<input type="image" width=28 height=23 border=0 value="Go" name="Go" src="/images/go.gif" align=absmiddle>

</form>


<!-- Empty Reference Subhead -->

<!--ISBN=1576104265//-->
<!--TITLE=Perl Core Language Little Black Book//-->
<!--AUTHOR=Steven Holzner//-->
<!--PUBLISHER=The Coriolis Group//-->
<!--CHAPTER=20//-->
<!--PAGES=439-445//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="20-02.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="20-04.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>Because we use the CGI method <B>end_html</B> to create the <B>&lt/BODY&gt&lt/HTML&gt</B> string, we move back by exactly the length of that generated string, which handles the possibility that <B>end_html</B> may print out something different in future versions.</P>
<P>Then the code overwrites the <B>&lt/BODY&gt&lt/HTML&gt</B> tags with the new data, adding new <B>&lt/BODY&gt&lt/HTML&gt</B> tags at the end with the CGI <B>end_html</B> method.</P>
<P>After the person&#146;s name and comments are recorded, guestbook.cgi creates the page you see in Figure 20.3, thanking the user for his or her comments and displaying a hyperlink that lets the user view the guest book if he or she wants. This means if you use this script, you should change the generic URL in guestbook.cgi so it points to book.htm (and make sure you set book.htm&#146;s permission levels low enough so guestbook.cgi can write to it):</P>
<I><P><A NAME="Fig3"></A><A HREF="javascript:displayWindow('images/20-03.jpg',631,553 )"><IMG SRC="images/20-03t.jpg"></A>
<BR><A HREF="javascript:displayWindow('images/20-03.jpg',631,553)"><FONT COLOR="#000077"><B>Figure 20.3</B></FONT></A>&nbsp;&nbsp;The guest book comment is accepted.</I>
</P>
<!-- CODE SNIP //-->
<PRE>
&#147;If you want to take a look at the guest book, &#148;,
$co-&gta(
{href=&gt&#147;&lthttp://www.yourserver.com/username/cgi/book.htm&gt&#148;},
&#147;click here&#148;), &#147;.&#148;,
</PRE>
<!-- END CODE SNIP //-->
<P>If the user does click the hyperlink, he or she will see the guest book itself, book.htm, as shown in Figure 20.4, and, of course, you can put links to that page in any other Web page on your site. The user&#146;s name and comments are displayed in the guest book, along with the time and date he or she made the entry, as you can see in Figure 20.4.
</P>
<P>The guestbook.cgi file renders harmless any HTML users may try to place in the guest book by replacing any &lt characters with the HTML <B>&amplt</B> code (using this code: <B>$username =~ s/&lt/&amplt/, and $text =~ s/&lt/&amplt/</B>), which will display &#147;&lt&#148; instead of letting the browser try to interpret the user&#146;s comments as HTML. This means that any HTML that users try to insert in your guest book will appear as text instead of being executed. You may want to add additional error checking.</P>
<I><P><A NAME="Fig4"></A><A HREF="javascript:displayWindow('images/20-04.jpg',631,553 )"><IMG SRC="images/20-04t.jpg"></A>
<BR><A HREF="javascript:displayWindow('images/20-04.jpg',631,553)"><FONT COLOR="#000077"><B>Figure 20.4</B></FONT></A>&nbsp;&nbsp;The guest book.</I>
</P>
<P>Note that you can customize guestbook.cgi to accept email addresses (although more and more users are reluctant to supply these, not just because of privacy but also because of the programs that scan Web pages for email addresses that are then sold in lists). You can also customize the book.htm guest book file, adding images with the <B>&ltIMG&gt</B> tag, setting backgrounds, and more, as you could with any Web page. Just be careful that the very <I>last</I> text in book.htm is <B>&lt/BODY&gt&lt/HTML&gt</B> (or the current output of CGI&#146;s <B>end_html</B> method in case it&#146;s been changed in a new version of CGI.pm) so guestbook.cgi can move back the correct distance and overwrite these tags when adding new comments.</P>
<P><B><I>Listing 20.2</B> guestbook.htm.</I></P>
<!-- CODE //-->
<PRE>
&ltHTML&gt
&ltHEAD&gt
&ltTITLE&gtAdd to the guest book&lt/TITLE&gt
&lt/HEAD&gt
&ltBODY&gt
&ltH1&gtPlease add to my guest book...&lt/H1&gt
&ltFORM METHOD = POST ACTION =
&#147;&lthttp://www.yourserver.com/user/cgi/guestbook.cgi&gt;&#148;
&ltBR&gt
&ltCENTER&gt
Please enter your name:
&ltP&gt
&ltINPUT TYPE = &#147;TEXT&#148; NAME = &#147;username&#148;&gt
&lt/INPUT&gt
&ltBR&gt
Please enter your comments:
&ltP&gt
&ltTEXTAREA ROWS = 8 COLS = 40 NAME = &#147;comments&#148;&gt
&lt/TEXTAREA&gt
&ltBR&gt
&ltBR&gt
&ltINPUT TYPE = SUBMIT VALUE = &#147;Send&#148;&gt
&ltINPUT TYPE = RESET VALUE = &#147;Reset&#148;&gt
&lt/CENTER&gt
&lt/FORM&gt
&lt/BODY&gt
&lt/HTML&gt
</PRE>
<!-- END CODE //-->
<P><B><I>Listing 20.3</B> guestbook.cgi.</I></P>
<!-- CODE //-->
<PRE>
#!/usr/bin/perl
use CGI;

$co = new CGI;

open (BOOK, &#147;&gt&gtbook.htm&#148;) or die &#147;Could not open guest
    book.&#148;;
seek (BOOK, -length($co-&gtend_html), 2);

$date = &#145;date&#146;;
chop($date);
$username = $co-&gtparam(&#145;username&#146;);
$username =~ s/&lt/&amplt/;
$text = $co-&gtparam(&#145;comments&#146;);
$text =~ s/&lt/&amplt/;
print BOOK
$co-&gth3(
    &#147;New comments by &#148;, $username, &#147; on &#148;, $date,
    $co-&gtp,
    $text,
),
$co-&gthr,
$co-&gtend_html;
close BOOK;

print $co-&gtheader,

$co-&gtstart_html(
    -title=&gt&#145;Guest Book Example&#146;,
    -author=&gt&#145;Steve&#146;,
    -BGCOLOR=&gt&#145;white&#146;,
    -LINK=&gt&#145;red&#146;
);

print

$co-&gtcenter($co-&gth1(&#145;Thanks for adding to the guest book!&#146;)),

&#147;If you want to take a look at the guest book, &#148;,
$co-&gta(
{href=&gt&#147;&lthttp://www.yourserver.com/user/cgi/book.htm&gt&#148;},
&#147;click here&#148;
), &#147;.&#148;,

$co-&gthr,

$co-&gtend_html;
</PRE>
<!-- END CODE //-->
<P><B><I>Listing 20.4</B> book.htm.</I></P>
<!-- CODE //-->
<PRE>
&ltHTML&gt
&ltHEAD&gt
&ltTITLE&gt
The Guest Book
&lt/TITLE&gt
&lt/HEAD&gt

&ltBODY&gt
&ltCENTER&gt
&ltH1&gtHere is the guest book...&lt/H1&gt
&ltHR&gt

&lt/BODY&gt&lt/HTML&gt
</PRE>
<!-- END CODE //-->
<H4 ALIGN="LEFT"><A NAME="Heading9"></A><FONT COLOR="#000077">Emailing From A CGI Script</FONT></H4>
<P>Although you can store user feedback on your ISP as in the previous guest book example, it&#146;s sometimes more convenient to have feedback emailed directly to you. This next script does just that. Note that this code has to use system resources to support email, so the script is operating-system dependent. I&#146;m assuming this script will run under Unix here.
</P>
<P>The email application consists of an HTML file, email.htm, which is the front end that lets users write email from their Web browsers, as seen in Figure 20.5. There&#146;s also a CGI script, email.cgi, which accepts the email, sends it, and displays a confirmation message, as shown in Figure 20.6.</P>
<P>For reference, email.htm appears in Listing 20.5 and email.cgi appears in Listing 20.6.</P>
<P>The email is sent just as any standard email would be sent; for the example in Figure 20.5, this is the email you&#146;d get (note that this application lets users set their own email address, so the From: field may contain a fake or invalid address):</P>
<I><P><A NAME="Fig5"></A><A HREF="javascript:displayWindow('images/20-05.jpg',585,571 )"><IMG SRC="images/20-05t.jpg"></A>
<BR><A HREF="javascript:displayWindow('images/20-05.jpg',585,571)"><FONT COLOR="#000077"><B>Figure 20.5</B></FONT></A>&nbsp;&nbsp;Writing the email.</I>
<I></P>
<P><A NAME="Fig6"></A><A HREF="javascript:displayWindow('images/20-06.jpg',585,291 )"><IMG SRC="images/20-06t.jpg"></A>
<BR><A HREF="javascript:displayWindow('images/20-06.jpg',585,291)"><FONT COLOR="#000077"><B>Figure 20.6</B></FONT></A>&nbsp;&nbsp;Email confirmation.</I>
</P>
<!-- CODE //-->
<PRE>
Date: Thu, 12 Nov 15:26:57 -0500 (EST)
To: user@yourserver.com
From: user@aserver.com
Subject: Friendly greeting

Dear you:

        How are you? Write when you get the chance!

                                              A. F. User
</PRE>
<!-- END CODE //-->
<P>Using this application, you can have user data emailed to you directly, instead of having to check a log file of some kind on your ISP.
</P>
<P>When you customize this application, don&#146;t forget to replace the generic URL in email.htm that points to email.cgi with the correct URL:</P>
<!-- CODE SNIP //-->
<PRE>
&ltHR&gt&ltFORM METHOD=&#147;POST&#148;
ACTION=&#147;&lthttp://www.yourserver.com/username/cgi/email.cgi&gt&#148;
ENCTYPE=&#147;application/x-www-form-urlencoded&#148;&gt
</PRE>
<!-- END CODE SNIP //-->
<P>Also, make sure the path to your system&#146;s sendmail application is correct in email.cgi (it&#146;s usually /usr/lib/sendmail on Unix systems, so it&#146;s set that way in email.cgi):
</P>
<!-- CODE SNIP //-->
<PRE>
$text = $co-&gtparam(&#145;text&#146;);
$text =~ s/&lt/&amplt/;
open(MAIL, &#145;| /usr/lib/sendmail -t -oi&#146;);
print MAIL &lt&ltEOF;
</PRE>
<!-- END CODE SNIP //-->
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="20-02.html">Previous</A></TD>
<TD><A HREF="../ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="20-04.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>

<hr width="90%" size="1" noshade>
<div align="center">
<font face="Verdana,sans-serif" size="1">Copyright &copy; <a href="/reference/tcg00001.html">The Coriolis Group, Inc.</a></font>
</div>
<!-- all of the reference materials (books) have the footer and subfoot reveresed -->
<!-- reference_subfoot = footer -->
<!-- reference_footer = subfoot -->

<!-- BEGIN SUB FOOTER -->
	<br>
	<img src="/images/dotclear.gif" width="5" height="7" border="0">
	</TD>
    </TR>
	</TABLE>
	
	<table width="100%" border=0 cellpadding=0 cellspacing=0>
	<tr>
		<td align="left" width="160"><img src="/images/bot_curve.jpg" width="160" alt="" border="0"></td>
		<td align="left" valign="top" nowrap><a href="/index2.html"><img src="/images/top_tabs/home_bot.gif" alt="Home" border="0"></a><a href="/pick-account.html"><img src="/images/top_tabs/account_info_bot.gif" alt="Account Info" border="0"></a><a href="/PSUser/usrreg.htm?AdminAction=InitAdd&Locale=en&URI=/"><img src="/images/top_tabs/subscribe_bot.gif" alt="Subscribe" border="0"></a><a href="/PSUser/psuserauth.htm?cmd=login&URI=/"><img src="/images/top_tabs/login_bot.gif" alt="Login" border="0"></a><a href="/search/"><img src="/images/top_tabs/search_bot.gif" alt="Search" border="0"></a><a href="/PSUser/EWIPOMain.html"><img src="/images/top_tabs/my_itknowledge_bot.gif" alt="My ITKnowledge" border="0"></a><a href="/faq/faq.html"><img src="/images/top_tabs/faq_bot.gif" alt="FAQ" border="0"></a><a href="/sitemap.html"><img src="/images/top_tabs/sitemap_bot.gif" alt="Sitemap" border="0"></a><a href="/contactus.html"><img src="/images/top_tabs/contact_us_bot.gif" alt="Contact Us" border="0"></a></td> 
	</tr>
	</table>
		
	<table width="100%" bgcolor="#003366" border=0 cellpadding=0 cellspacing=0>
	<tr>
		<td align="left" width=145><img src="/images/clear_pixel.gif" width=145 height="1" alt="" border="0"></td>
				
<!-- END SUB FOOTER -->

<!-- all of the books have the footer and subfoot reveresed -->
<!-- reference_subfoot = footer -->
<!-- reference_footer = subfoot -->

<!-- FOOTER -->
			
<td align="left" bgcolor="#003366">
<table border="0" cellspacing="10" cellpadding="5">
<tr>
<td align="center">
<font face="arial, helvetica" size="1" color="#cccccc"><b><a href="/products.html"><font color="#0099CC">Products</font></a>&nbsp;|&nbsp; <a href="/contactus.html"><font color="#0099CC">Contact Us</font></a>&nbsp;|&nbsp; <a href="http://www.earthweb.com/dlink.corp|about_us-jhtml.72.0.-.0.jhtml" target="resource window"><font color="#0099CC">About Us</font></a>&nbsp;|&nbsp; <a href="http://www.earthweb.com/dlink.corp|privacy-jhtml.72.0.-.-.jhtml" target="resource window"><font color="#0099CC">Privacy</font></a> &nbsp;|&nbsp; <a href="http://www.itmarketer.com/" target="resource window"><font color="#0099CC">Ad Info</font></a> &nbsp;|&nbsp; <a href="/index2.html"><font color="#0099CC">Home</font></a></b>
<br><br>Use of this site is subject to certain <a href="/agreement.html"><font color="#0099CC">Terms &amp; Conditions</font></a>, <a href="/copyright.html"><font color="#0099CC">Copyright &copy; 1996-2000 EarthWeb Inc.</font></a> All rights reserved.  Reproduction in whole or in part in any form or medium without express written <a href="http://www.earthweb.com/dlink.corp|permissions-jhtml.72.0.-.-.jhtml" target="resource window"><font color="#0099CC">permission</font></a> of EarthWeb is prohibited. Read EarthWeb's <A HREF="http://www.earthweb.com/dlink.corp|privacy-jhtml.72.0.-.-.jhtml" target="resource window"><font color="#0099CC">privacy</font></A> statement.</font><br><br>
</td>
</tr>
</table>

<!-- netranger link to stop spiders -->

<a href="ITKN1a2b3c4d5e6f7g8h9idefcon4.html">
<img src="/images/dotclear.gif" border="0" height="1" width="1" align="left"></a>
</td>
		</tr>
</table>
<SCRIPT LANGUAGE="javascript">
<!--
document.write('<LAYER SRC="http://ad.doubleclick.net/adl/itk.earthweb.dart/b_soft_dev;a=b_soft_dev1;sz=468x60;ord=' + ord + '" width=468 height=60 visibility="hidden" onLoad="moveToAbsolute(layer1.pageX,layer1.pageY);clip.height=60;clip.width=468; visibility=\'show\';"></LAYER>');
document.write('<LAYER SRC="http://ad.doubleclick.net/adl/itk.earthweb.dart/b_soft_dev;a=b_soft_dev4;sz=160x60;ord=' + ord + '" width=160 height=60 visibility="hidden" onLoad="moveToAbsolute(layer4.pageX,layer4.pageY);clip.height=60;clip.width=160; visibility=\'show\';"></LAYER>');
document.write('<LAYER SRC="http://ad.doubleclick.net/adl/itk.earthweb.dart/b_soft_dev;a=b_soft_dev3;sz=125x125;ord=' + ord + '" width=125 height=125 visibility="hidden" onLoad="moveToAbsolute(layer3.pageX,layer3.pageY);clip.height=125;clip.width=125; visibility=\'show\';"></LAYER>');
//-->
</SCRIPT>
</BODY>
</HTML>

<!-- END FOOTER -->

